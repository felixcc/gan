<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Gan : GrooveAdmiN is a light weight debugging/management tool embedded in Java web applications." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Gan</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/safrain/gan">View on GitHub</a>

          <h1 id="project_title">Gan</h1>
          <h2 id="project_tagline">GrooveAdmiN is a light weight debugging/management tool embedded in Java web applications.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/safrain/gan/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/safrain/gan/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="grooveadmin" class="anchor" href="#grooveadmin"><span class="octicon octicon-link"></span></a>GrooveAdmiN</h1>

<p>GrooveAdmiN 是一个简单轻便的Java Web工程管理工具</p>

<p>你可以使用它上传本地的groovy文件并在你的服务器上执行</p>

<p>使用GrooveAdmiN，你可以借助强大的动态语言来简化你的工作</p>

<h2>
<a name="%E7%89%B9%E6%80%A7" class="anchor" href="#%E7%89%B9%E6%80%A7"><span class="octicon octicon-link"></span></a>特性</h2>

<ul>
<li>在服务器端执行本地的脚本文件</li>
<li>轻便，几乎没有额外依赖，可以被轻松的整合到你的项目中</li>
<li>符合Restful语义</li>
<li>提供基于Bash的客户端，使用curl命令就可以安装 </li>
<li>可以管理正在运行的任务</li>
<li>易于定制和扩展</li>
</ul><h2>
<a name="%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" class="anchor" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="octicon octicon-link"></span></a>使用说明</h2>

<h3>
<a name="%E5%B0%86grooveadmin%E6%95%B4%E5%90%88%E5%88%B0%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD" class="anchor" href="#%E5%B0%86grooveadmin%E6%95%B4%E5%90%88%E5%88%B0%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE%E4%B8%AD"><span class="octicon octicon-link"></span></a>将GrooveAdmiN整合到你的项目中</h3>

<p>1.在你的classpath下加入如下依赖</p>

<ul>
<li><a href="https://oss.sonatype.org/service/local/repositories/snapshots/content/com/github/safrain/gan/1.0-SNAPSHOT/gan-1.0-20131010.060527-1.jar">GrooveAdmiN</a></li>
<li>
<a href="http://groovy.codehaus.org/Download">Groovy Runtime</a> 任意高于1.8.6的版本皆可</li>
</ul><p>对于Maven管理的项目，把如下内容加入你的pom中</p>

<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.safrain&lt;/groupId&gt;
    &lt;artifactId&gt;gan&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt;
    &lt;artifactId&gt;groovy-all&lt;/artifactId&gt;
    &lt;version&gt;1.8.9&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>2.在你的 <em>web.xml</em> 加入GANFilter</p>

<p><strong>当心:直接暴露这个Filter可能会导致严重的安全问题，请考虑限制客户端IP或配合有身份验证功能的Filter使用</strong></p>

<pre><code>&lt;filter&gt;
    &lt;filter-name&gt;GAN&lt;/filter-name&gt;
    &lt;filter-class&gt;com.github.safrain.gan.GANFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;GAN&lt;/filter-name&gt;
    &lt;url-pattern&gt;/gan&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</code></pre>

<p><strong>Filter 初始化参数</strong></p>

<p><em>charset</em> 请求和响应的编码， 默认为 'utf-8'</p>

<h3>
<a name="%E4%BD%BF%E7%94%A8-grooveadmin" class="anchor" href="#%E4%BD%BF%E7%94%A8-grooveadmin"><span class="octicon octicon-link"></span></a>使用 GrooveAdmiN</h3>

<h4>
<a name="%E6%98%BE%E7%A4%BA%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF" class="anchor" href="#%E6%98%BE%E7%A4%BA%E5%B8%AE%E5%8A%A9%E4%BF%A1%E6%81%AF"><span class="octicon octicon-link"></span></a>显示帮助信息</h4>

<p>对 GANFilter 所在的路径进行HTTP GET，可以显示帮助信息</p>

<pre><code>curl -s http://localhost/gan
</code></pre>

<h4>
<a name="%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC%E5%B9%B6%E6%89%A7%E8%A1%8C" class="anchor" href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC%E5%B9%B6%E6%89%A7%E8%A1%8C"><span class="octicon octicon-link"></span></a>上传脚本并执行</h4>

<p>对 GANFilter 所在的路径进行HTTP POST, 脚本会在服务器端被执行</p>

<pre><code>curl -X POST http://localhost/gan -T foo.groovy
</code></pre>

<p>或直接上传脚本内容</p>

<pre><code>curl -X POST http://localhost/gan -d "println 'Hello'"
</code></pre>

<h4>
<a name="%E8%BE%93%E5%87%BA%E5%88%B0response" class="anchor" href="#%E8%BE%93%E5%87%BA%E5%88%B0response"><span class="octicon octicon-link"></span></a>输出到Response</h4>

<p>直接使用 println 输出到 Response， 脚本环境中的 <em>stdout</em> 和 <em>stderr</em> 都已经被重定向到 Response 中</p>

<pre><code>println 'Hello GrooveAdmiN'
</code></pre>

<h4>
<a name="%E8%8E%B7%E5%BE%97%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0" class="anchor" href="#%E8%8E%B7%E5%BE%97%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0"><span class="octicon octicon-link"></span></a>获得请求参数</h4>

<p>就像在Java中一样，使用脚本环境中的内置变量即可</p>

<pre><code>println _request.getParameter('foo')
</code></pre>

<h4>
<a name="%E8%AE%BF%E9%97%AE%E6%93%8D%E4%BD%9C-spring-%E7%8E%AF%E5%A2%83" class="anchor" href="#%E8%AE%BF%E9%97%AE%E6%93%8D%E4%BD%9C-spring-%E7%8E%AF%E5%A2%83"><span class="octicon octicon-link"></span></a>访问/操作 Spring 环境</h4>

<p>参考下面的 <em>扩展</em> 部分</p>

<p><strong>脚本环境中的内置变量</strong></p>

<p><em>_request</em> Http请求</p>

<p><em>_response</em> Http响应</p>

<p><em>_servlet_context</em> Servlet上下文</p>

<p><em>_this</em> GANFilter 本身</p>

<p><em>_engine</em> 运行当前脚本的 javax.script.ScriptEngine</p>

<h3>
<a name="%E4%BD%BF%E7%94%A8bash%E5%AE%A2%E6%88%B7%E7%AB%AF" class="anchor" href="#%E4%BD%BF%E7%94%A8bash%E5%AE%A2%E6%88%B7%E7%AB%AF"><span class="octicon octicon-link"></span></a>使用Bash客户端</h3>

<p>假设你把 GANFilter 配置在了 http://localhost/ 的项目中, '/gan' 作为GANFilter的路径:</p>

<h4>
<a name="%E5%AE%89%E8%A3%85" class="anchor" href="#%E5%AE%89%E8%A3%85"><span class="octicon octicon-link"></span></a>安装</h4>

<pre><code>curl -s http://localhost/gan?install | bash
</code></pre>

<p>GrooveAdmiN 的bash 客户端 'gan' 会被下载到当前目录中，当前的服务器地址会被用作默认服务器地址(存储在 ~/.gan_host中)</p>

<h4>
<a name="%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC%E5%B9%B6%E6%89%A7%E8%A1%8C-1" class="anchor" href="#%E4%B8%8A%E4%BC%A0%E8%84%9A%E6%9C%AC%E5%B9%B6%E6%89%A7%E8%A1%8C-1"><span class="octicon octicon-link"></span></a>上传脚本并执行</h4>

<pre><code>./gan foo.groovy
</code></pre>

<h4>
<a name="%E6%8C%87%E5%AE%9A%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%B0%86%E5%85%B6%E4%BF%9D%E5%AD%98%E4%B8%BA%E9%BB%98%E8%AE%A4%E5%9C%B0%E5%9D%80" class="anchor" href="#%E6%8C%87%E5%AE%9A%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%B0%86%E5%85%B6%E4%BF%9D%E5%AD%98%E4%B8%BA%E9%BB%98%E8%AE%A4%E5%9C%B0%E5%9D%80"><span class="octicon octicon-link"></span></a>指定服务器地址并将其保存为默认地址</h4>

<p>脚本会在  上被执行, 客户端的默认地址会被修改为 </p>

<pre><code>./gan -h &lt;server address&gt; foo.groovy
</code></pre>

<h4>
<a name="%E8%BF%90%E8%A1%8C%E4%B8%AD%E8%84%9A%E6%9C%AC%E5%88%97%E8%A1%A8" class="anchor" href="#%E8%BF%90%E8%A1%8C%E4%B8%AD%E8%84%9A%E6%9C%AC%E5%88%97%E8%A1%A8"><span class="octicon octicon-link"></span></a>运行中脚本列表</h4>

<pre><code>./gan -l
</code></pre>

<h4>
<a name="%E7%BB%93%E6%9D%9F%E8%BF%90%E8%A1%8C%E4%B8%AD%E7%9A%84%E8%84%9A%E6%9C%AC" class="anchor" href="#%E7%BB%93%E6%9D%9F%E8%BF%90%E8%A1%8C%E4%B8%AD%E7%9A%84%E8%84%9A%E6%9C%AC"><span class="octicon octicon-link"></span></a>结束运行中的脚本</h4>

<pre><code>./gan -k uuid
</code></pre>

<h3>
<a name="%E6%89%A9%E5%B1%95" class="anchor" href="#%E6%89%A9%E5%B1%95"><span class="octicon octicon-link"></span></a>扩展</h3>

<h4>
<a name="%E8%84%9A%E6%9C%AC%E6%89%A9%E5%B1%95" class="anchor" href="#%E8%84%9A%E6%9C%AC%E6%89%A9%E5%B1%95"><span class="octicon octicon-link"></span></a>脚本扩展</h4>

<p><em>脚本扩展</em> 会在你上传的脚本执行前被执行，在脚本扩展中，你可以在脚本环境中定义一些变量和方法，用来支持各种框架，或者放一些你常用的工具方法</p>

<p>下面是一些默认的扩展功能</p>

<p><strong>任务管理</strong> (com/github/safrain/gan/task.groovy)</p>

<p>显示所有运行中的脚本</p>

<pre><code>_gan_running()
</code></pre>

<p>停止运行中的脚本</p>

<pre><code>_gan_kill('uuid')
</code></pre>

<p><strong>Spring支持</strong> (com/github/safrain/gan/spring.groovy)</p>

<p>访问Spring环境中的bean</p>

<pre><code>def someBean = beans.beanName
def anotherBean = beans['beanName']
</code></pre>

<p>显示所有定义在Spring环境中的bean</p>

<pre><code>println beans
</code></pre>

<p>访问Spring环境</p>

<pre><code>println beans.context
</code></pre>

<h3>
<a name="%E5%AE%9A%E5%88%B6" class="anchor" href="#%E5%AE%9A%E5%88%B6"><span class="octicon octicon-link"></span></a>定制</h3>

<p>下面的 com.github.safrain.gan.GANFilter 中的若干方法, 是被设计用来被覆盖的，以实现方便的定制</p>

<ul>
<li>
<strong>createScriptEngine</strong> 返回你自己的脚本引擎，用来支持其他的语言，例如Scala，Javascript等</li>
<li>
<strong>getScriptBeforeEvaluation</strong> 返回你自己的脚本扩展列表</li>
<li>
<strong>getWelcomeScreen</strong> 返回你自定义的帮助信息</li>
<li>
<strong>getInstallScript</strong> 返回客户端安装脚本</li>
<li>
<strong>getClient</strong> 返回你定制的客户端</li>
<li>
<strong>getReplacements</strong> 返回帮助信息和客户端中需要被替换的键值对，例如服务器地址</li>
</ul><h2>
<a name="%E8%AF%95%E4%B8%80%E4%B8%8B" class="anchor" href="#%E8%AF%95%E4%B8%80%E4%B8%8B"><span class="octicon octicon-link"></span></a>试一下？</h2>

<p>你需要安装 <a href="http://www.gradle.org/">gradle</a> 来构建和运行示例项目</p>

<p>从git clone项目</p>

<pre><code>git clone git@github.com:safrain/gan.git
</code></pre>

<p>在Jetty中运行项目</p>

<pre><code>gradle jettyRunWar
</code></pre>

<p>然后显示帮助信息，按照其中的提示做就可以了</p>

<pre><code>curl localhost:8080/gan
</code></pre>

<h2>
<a name="todos" class="anchor" href="#todos"><span class="octicon octicon-link"></span></a>TODOs</h2>

<ul>
<li>客户端支持HTTP 基本认证和 HTTP 摘要认证</li>
</ul><h1>
<a name="grooveadmin-1" class="anchor" href="#grooveadmin-1"><span class="octicon octicon-link"></span></a>GrooveAdmiN</h1>

<p>GrooveAdmiN is a light weight debugging/management tool embedded in Java web applications.</p>

<p>You can upload local groovy script file and run it on your server.</p>

<p>Through GrooveAdmiN, you can do your management work easily with the power of dynamic language.</p>

<h2>
<a name="features" class="anchor" href="#features"><span class="octicon octicon-link"></span></a>Features</h2>

<ul>
<li>Upload local script file and run it on server</li>
<li>Lightweight, minimum dependencies, easy to embed into your project</li>
<li>GrooveAdmiN is Restful </li>
<li>Bash client, curl to install, one command get everything done</li>
<li>Running task management</li>
<li>Easy to extend and customize</li>
</ul><h2>
<a name="user-guide" class="anchor" href="#user-guide"><span class="octicon octicon-link"></span></a>User Guide</h2>

<h3>
<a name="embbed-grooveadmin-in-you-project" class="anchor" href="#embbed-grooveadmin-in-you-project"><span class="octicon octicon-link"></span></a>Embbed GrooveAdmiN in you project</h3>

<p>1.Add following jars into you classpath</p>

<ul>
<li><a href="https://oss.sonatype.org/service/local/repositories/snapshots/content/com/github/safrain/gan/1.0-SNAPSHOT/gan-1.0-20131010.060527-1.jar">GrooveAdmiN</a></li>
<li>
<a href="http://groovy.codehaus.org/Download">Groovy Runtime</a> Any version greater than 1.8.6 is OK </li>
</ul><p>For maven projects, add below content into you pom</p>

<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;com.github.safrain&lt;/groupId&gt;
    &lt;artifactId&gt;gan&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/dependency&gt;

&lt;dependency&gt;
    &lt;groupId&gt;org.codehaus.groovy&lt;/groupId&gt;
    &lt;artifactId&gt;groovy-all&lt;/artifactId&gt;
    &lt;version&gt;1.8.9&lt;/version&gt;
&lt;/dependency&gt;
</code></pre>

<p>2.Add GANFilter configuration into your <em>web.xml</em></p>

<p><strong>Attention:Exposing this filter may cause serious security problems, consider restrict remote address or add an authentication filter</strong></p>

<pre><code>&lt;filter&gt;
    &lt;filter-name&gt;GAN&lt;/filter-name&gt;
    &lt;filter-class&gt;com.github.safrain.gan.GANFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;GAN&lt;/filter-name&gt;
    &lt;url-pattern&gt;/gan&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</code></pre>

<p><strong>Filter init params</strong></p>

<p><em>charset</em> Request and Response character encoding, 'utf-8' as default.</p>

<h3>
<a name="using-grooveadmin" class="anchor" href="#using-grooveadmin"><span class="octicon octicon-link"></span></a>Using GrooveAdmiN</h3>

<h4>
<a name="show-help-screen" class="anchor" href="#show-help-screen"><span class="octicon octicon-link"></span></a>Show help screen</h4>

<p>You could get some help by using an http GET on GANFilter</p>

<pre><code>curl -s http://localhost/gan
</code></pre>

<h4>
<a name="upload-a-script" class="anchor" href="#upload-a-script"><span class="octicon octicon-link"></span></a>Upload a script</h4>

<p>Use an http POST on GANFilter with a file, the file will be executed on server</p>

<pre><code>curl -X POST http://localhost/gan -T foo.groovy
</code></pre>

<p>or</p>

<pre><code>curl -X POST http://localhost/gan -d "println 'Hello'"
</code></pre>

<h4>
<a name="output-to-servlet-response" class="anchor" href="#output-to-servlet-response"><span class="octicon octicon-link"></span></a>Output to servlet response</h4>

<p>Use println to directly output to servlet response, <em>stdout</em> and <em>stderr</em> had been redirected to servlet response</p>

<pre><code>println 'Hello GrooveAdmiN'
</code></pre>

<h4>
<a name="get-request-parameters" class="anchor" href="#get-request-parameters"><span class="octicon octicon-link"></span></a>Get request parameters</h4>

<p>Access built-in variables, and use them just like in Java</p>

<pre><code>println _request.getParameter('foo')
</code></pre>

<h4>
<a name="accessmanipulate-spring-context" class="anchor" href="#accessmanipulate-spring-context"><span class="octicon octicon-link"></span></a>Access/Manipulate spring context</h4>

<p>See <em>Extending</em> section below</p>

<p><strong>Built-in variables</strong></p>

<p><em>_request</em> Just the request</p>

<p><em>_response</em> Just the response</p>

<p><em>_servlet_context</em> Just the servletContext</p>

<p><em>_this</em> GANFilter itself</p>

<p><em>_engine</em> the javax.script.ScriptEngine running current script</p>

<h3>
<a name="using-bash-client" class="anchor" href="#using-bash-client"><span class="octicon octicon-link"></span></a>Using bash client</h3>

<p>Assume that you configured GANFilter in you application at http://localhost/, '/gan' as url pattern:</p>

<h4>
<a name="install" class="anchor" href="#install"><span class="octicon octicon-link"></span></a>Install</h4>

<pre><code>curl -s http://localhost/gan?install | bash
</code></pre>

<p>GrooveAdmiN bash client 'gan' will be downloaded to current folder, current server address will be used as default server address of the client(in ~/.gan_host).</p>

<h4>
<a name="upload-script-and-run" class="anchor" href="#upload-script-and-run"><span class="octicon octicon-link"></span></a>Upload script and run</h4>

<p>You can upload a local script file and execute it on server.</p>

<pre><code>./gan foo.groovy
</code></pre>

<h4>
<a name="specify-server-address-and-save-it-as-default-server-address" class="anchor" href="#specify-server-address-and-save-it-as-default-server-address"><span class="octicon octicon-link"></span></a>Specify server address and save it as default server address</h4>

<p>Script will be executed at , and default server address of the client will be changed to </p>

<pre><code>./gan -h &lt;server address&gt; foo.groovy
</code></pre>

<h4>
<a name="list-running-scripts" class="anchor" href="#list-running-scripts"><span class="octicon octicon-link"></span></a>List running scripts</h4>

<pre><code>./gan -l
</code></pre>

<h4>
<a name="kill-running-script" class="anchor" href="#kill-running-script"><span class="octicon octicon-link"></span></a>Kill running script</h4>

<pre><code>./gan -k uuid
</code></pre>

<h3>
<a name="extending" class="anchor" href="#extending"><span class="octicon octicon-link"></span></a>Extending</h3>

<h4>
<a name="script-extensions" class="anchor" href="#script-extensions"><span class="octicon octicon-link"></span></a>Script extensions</h4>

<p><em>Script Extensions</em> will be executed before the script you uploaded,
In the extension script, you can put some variables or function into the script context to add support to various frameworks
Or you can simply put some of your favorite utilities in it.</p>

<p>Here are some default extensions</p>

<p><strong>Task management</strong> (com/github/safrain/gan/task.groovy)</p>

<p>List all running scripts</p>

<pre><code>_gan_running()
</code></pre>

<p>Kill running script</p>

<pre><code>_gan_kill('uuid')
</code></pre>

<p><strong>Spring support</strong> (com/github/safrain/gan/spring.groovy)</p>

<p>Access beans in spring context</p>

<pre><code>def someBean = beans.beanName
def anotherBean = beans['beanName']
</code></pre>

<p>List beans defined in spring context</p>

<pre><code>println beans
</code></pre>

<p>Access spring application context</p>

<pre><code>println beans.context
</code></pre>

<h3>
<a name="customizing" class="anchor" href="#customizing"><span class="octicon octicon-link"></span></a>Customizing</h3>

<p>Here are some methods in com.github.safrain.gan.GANFilter, they are designed to be overriden for sake of easy customizing</p>

<ul>
<li>
<strong>createScriptEngine</strong> Return your script engine to support some other language, like Javascript, Scala, etc.</li>
<li>
<strong>getScriptBeforeEvaluation</strong> Return your customized extension script list</li>
<li>
<strong>getWelcomeScreen</strong> Return a welcome message while doing http GET on GANFilter</li>
<li>
<strong>getInstallScript</strong> Return bash script using to install the client</li>
<li>
<strong>getClient</strong> Return the customized bash client</li>
<li>
<strong>getReplacements</strong> Return k/v pairs for replacing, like server address</li>
</ul><h2>
<a name="try-it-now" class="anchor" href="#try-it-now"><span class="octicon octicon-link"></span></a>Try it now</h2>

<p>You need <a href="http://www.gradle.org/">gradle</a> to build/run the example project</p>

<p>Clone the project</p>

<pre><code>git clone git@github.com:safrain/gan.git
</code></pre>

<p>Run the example project in jetty</p>

<pre><code>gradle jettyRunWar
</code></pre>

<p>Then show the welcome screen, and follow its instructions</p>

<pre><code>curl localhost:8080/gan
</code></pre>

<h2>
<a name="todos-1" class="anchor" href="#todos-1"><span class="octicon octicon-link"></span></a>TODOs</h2>

<ul>
<li>Support http basic auth and digest auth on bash client</li>
</ul>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Gan maintained by <a href="https://github.com/safrain">safrain</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
